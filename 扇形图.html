<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>扇形图</title>
    <script src="https://unpkg.com/konva@4.0.0/konva.min.js"></script>

</head>
<body>
   <canvas id="huabu" height="700" width="700"></canvas>
   <script>
    
       /** @type {HTMLCanvasElement} */ 
       let canvas = document.getElementById('huabu');
       let ctx = canvas.getContext('2d');
       

        let class1 = [
            {"value":".4",
            "color":"#57c",
            "title":"math"},
            {"value":".1",
            "color":"#33f",
            "title":"history"},
            {"value":".2",
            "color":"#f33",
            "title":"history"},
            {"value":".3",
            "color":"#330",
            "title":"history"},

        ]

        let radius = 100;
        let tempAngle = -90;
        let x0 = 400, y0 = 400;
        for(let i = 0; i < class1.length; i++){
            ctx.beginPath();
            ctx.moveTo(x0,y0);
            let angle = class1[i].value*360;
            ctx.fillStyle = class1[i].color;
            let startAngle = tempAngle*Math.PI/180;
            let endAngle = (tempAngle+angle)*Math.PI/180;
            ctx.arc(x0,y0,radius,startAngle,endAngle);

            let x, y;
            let text = class1[i].value*100+'%';
            let textAngle = tempAngle+1/2*angle;
            x = x0+Math.cos(textAngle*Math.PI/180)*(radius+20);
            y = y0+Math.sin(textAngle*Math.PI/180)*(radius+20);
            if(textAngle>90 || textAngle<-90){
                ctx.textAlign = 'end';
            }
            ctx.fillText(text,x,y);
            ctx.fill();
            tempAngle +=angle;
        }

   </script>
</body>
</html>
